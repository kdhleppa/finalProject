<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.camplex.project.item.mappers.ItemMapper2">


	<resultMap type="Item" id="item_rm">
	  	
	  	<id property="itemNo" column="ITEM_NO"/>
	  	  	
		<result property="itemType" column="ITEM_TYPE"/>
		<result property="inStoreCount" column="IN_STORE_COUNT"/>
		<result property="loanCount" column="LOAN_COUNT"/>
		<result property="itemPrice" column="ITEM_PRICE"/>
		<result property="itemName" column="ITEM_NAME"/>
		<result property="itemDescription" column="ITEM_DESCRIPTION"/>
		<result property="itemStatus" column="ITEM_STATUS"/>
		<result property="discountRate" column="DISCOUNT_RATE"/>
	    
	    
	    <collection property="imageList"
					select="selectImageList"
					column="ITEM_NO"
					javaType="java.util.ArrayList"
					ofType="ItemImg"
		 />
	    
	</resultMap>
	
	
	
	<resultMap type="ItemImg" id="itemImg_rm">
		
		<id property="itemImgNo" column="ITEM_IMG_NO"/>
		
		<result property="itemNo" column="ITEM_NO" />
		<result property="itemImgPath" column="ITEM_IMG_PATH" />
		<result property="itemImgRename" column="ITEM_IMG_RENAME" />
		<result property="itemImgOriginal" column="ITEM_IMG_ORIGINAL"/>
		<result property="itemImgOrder" column="ITEM_IMG_ORDER" />
	
	</resultMap>
	
	<select id="selectImageList" resultMap="itemImg_rm">
		SELECT ITEM_IMG_NO, ITEM_NO, ITEM_IMG_PATH
		FROM ITEM_IMG
	 	WHERE ITEM_NO = #{itemNo}
	</select>
	
	<select id="searchItems" resultMap="item_rm">
		SELECT ITEM_NO, ITEM_TYPE, ITEM_PRICE, ITEM_NAME, ITEM_DESCRIPTION, 
		ITEM_STATUS, DISCOUNT_RATE, ITEM_IMG_NO, (ITEM_IMG_PATH || ITEM_IMG_RENAME) THUMBNAIL, ITEM_IMG_ORDER
		FROM "ITEM"
		JOIN "ITEM_IMG" USING(ITEM_NO)
		ORDER BY "ITEM_NO"
	</select>
	

	  	
</mapper>
