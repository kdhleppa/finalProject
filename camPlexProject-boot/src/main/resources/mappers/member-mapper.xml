<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<!-- namespace를 Mapper 인터페이스로 지정 -->
<mapper namespace="com.camplex.project.member.mappers.MemberMapper">
	
	<resultMap type="Member" id="member_rm">
		<id property="memberNo" column="MEMBER_NO" />
		<result property="memberEmail" column="MEMBER_EMAIL" />
		<result property="memberPw" column="MEMBER_PW" />
		<result property="memberName" column="MEMBER_NAME" />
		<result property="memberNickname" column="MEMBER_NICKNAME" />
		<result property="memberPhone" column="MEMBER_PHONE" />
		<result property="memberProfileImg" column="MEMBER_PROFILE_IMG" />
		<result property="memberDelFl" column="MEMBER_DEL_FL" />
		<result property="memberType" column="MEMBER_TYPE" />
		<result property="enrollDate" column="ENROLL_DATE" />
	</resultMap>

	<resultMap type="CEOMember" id="ceoMember_rm">
		<id property="memberNo" column="NEMBER_NO"/>
		<result property="cmapName" column="CAMP_NAME" />
		<result property="campAdress" column="CAMP_ADDRESS" />
		<result property="ceoName" column="CEO_NAME" />
		<result property="businessLicense" column="BUSINESS_LICENSE" />
		<result property="tourLicense" column="TOUR_LICENSE" />
		<result property="accountHolder" column="ACCOUNT_HOLDER" />
		<result property="bankName" column="BANK_NAME" />
		<result property="ceoAccount" column="CEO_ACCOUNT" />
	</resultMap>
	
<!--	<resultMap type="MyPageInfoList" id="myPageInfoList_rm">
		<id property="memberNo" column="NEMBER_NO"/>
		<result property="wishListNo" column="WISHLIST_NO" />  캠핑장 이미지 
		<result property="campNo" column="CAMP_NO" />  캠핑장 이름
		<result property="rentalName" column="ITEM_NAME" />  렌탈 상품명 
		<result property="rentalName" column="ITEM_NAME" />  결제 정보 
		<result property="paymentState" column="PAYMENT_STATUS_NAME" />  결제 상태 
		<result property="paymentState" column="ITEM_IMG_RENAME" />  관심 상품 이미지 
		<result property="paymentState" column="PAYMENT_STATUS_NAME" />  관심 상품명 
		<result property="paymentState" column="PAYMENT_STATUS_NAME" />  문의사항 제목 
		<result property="paymentState" column="PAYMENT_STATUS_NAME" />  문의사항 답변 상태 
		<result property="paymentState" column="PAYMENT_STATUS_NAME" />  커뮤니티 제목 
		<result property="paymentState" column="PAYMENT_STATUS_NAME" />  커뮤니티 댓글 수 
	</resultMap>-->
	
	

	<!-- 로그인 -->
	<select id="login" resultMap="member_rm">
		SELECT MEMBER_NO, MEMBER_EMAIL, MEMBER_PW, MEMBER_NAME, MEMBER_NICKNAME,
		MEMBER_PHONE, MEMBER_PROFILE_IMG, MEMBER_TYPE,
		TO_CHAR(ENROLL_DATE, 'YYYY"년" MM"월" DD"일" HH24"시" MI"분" SS"초"') AS ENROLL_DATE
		FROM "MEMBER"
		WHERE MEMBER_DEL_FL = 'N'
		AND MEMBER_EMAIL = #{memberEmail}
	</select>
	
	
	<!-- 회원가입 -->
	<!-- 전화번호 입력 예정 -->
	<insert id="signUp">
		INSERT INTO "MEMBER"
		VALUES(SEQ_MEMBER_NO.NEXTVAL
		, #{memberEmail}
		, #{memberPw}
		, #{memberName}
		, #{memberNickname}
		, NULL
		, #{memberProfileImg}
		, DEFAULT, DEFAULT, DEFAULT)
	</insert>
	
	<!-- 비밀번호 조회 -->
	<select id="selectEncPw" parameterType="_int" resultType="string">
		SELECT MEMBER_PW FROM "MEMBER" WHERE MEMBER_NO = #{memberNo}
	</select>
	
	<!-- 회원 탈퇴 -->
	<update id="deleteMember" parameterType="_int">
		UPDATE "MEMBER" SET
		MEMBER_DEL_FL = 'Y'
		WHERE MEMBER_NO = #{memberNo}
	</update>
	
	<!-- 프로필 정보 수정 -->
	<update id="updateMember">
		UPDATE "MEMBER" SET
		MEMBER_NICKNAME = #{memberNickname},
		MEMBER_PROFILE_IMG = #{memberProfileImg}
		WHERE MEMBER_NO = #{memberNo}
	</update>
	
	<!-- 비밀번호 재설정을 위한 회원정보 찾기 -->
	<select id="searchMember" resultType="_int">
		SELECT COUNT(*)
		FROM "MEMBER"
		WHERE MEMBER_DEL_FL = 'N'
		AND MEMBER_EMAIL = #{memberEmail}
	</select>
	
	<!-- 비밀번호 재설정 (비밀번호 업데이트) -->
	<update id="changePw">
		UPDATE "MEMBER" SET 
		MEMBER_PW = #{memberPw}
		WHERE MEMBER_EMAIL = #{memberEmail}
		AND MEMBER_DEL_FL = 'N'
	</update>
	
	<!-- CEO 변경 신청 내역 조회 -->
	<select id="searchForm">
		SELECT MEMBER_NO
		FROM "CEO_MEMBER"
		WHERE MEMBER_NO = #{memberNo}
	</select>
	
	<!-- CEO 계정 변경 폼 전송 -->
	<insert id="levelUpFrom">
		INSERT INTO "CEO_MEMBER"
		VALUES(
		#{memberNo}
		, #{businessLicense}
		, #{ceoAccount}
		, #{tourLicense}
		, DEFAULT
		, #{campAdress}
		, #{cmapName}
		, #{ceoName}
		, #{accountHolder}
		, #{bankName})
	</insert>
	
	<!-- 카카오 로그인 시 회원인지 확인 -->
	<select id="checkMember">
		SELECT MEMBER_EMAIL
		FROM "MEMBER"
		WHERE MEMBER_EMAIL = #{email}
	</select>
	
	<!-- 회원 아닐시 카카오 자동 회원가입 -->
	<insert id="kakaoSignUp">
		INSERT INTO "MEMBER"
		VALUES(SEQ_MEMBER_NO.NEXTVAL
		, #{memberEmail}
		, DEFAULT
		, #{memberName}
		, DEFAULT
		, NULL
		, DEFAULT
		, DEFAULT, DEFAULT, DEFAULT)
	</insert>
	
	<!-- 카카오 계정 이메일로 로그인 -->
	<select id="kakaoLoginMember" resultMap="member_rm">
		SELECT MEMBER_NO, MEMBER_EMAIL, MEMBER_PW, MEMBER_NAME, MEMBER_NICKNAME,
		MEMBER_PHONE, MEMBER_PROFILE_IMG, MEMBER_TYPE,
		TO_CHAR(ENROLL_DATE, 'YYYY"년" MM"월" DD"일" HH24"시" MI"분" SS"초"') AS ENROLL_DATE
		FROM "MEMBER"
		WHERE MEMBER_DEL_FL = 'N'
		AND MEMBER_EMAIL = #{memberEmail}
	</select>
	
	<!-- 회원 아닐 시 네이버 자동 회원가입 -->
	<insert id="naverSignUp">
		INSERT INTO "MEMBER"
		VALUES(SEQ_MEMBER_NO.NEXTVAL
		, #{memberEmail}
		, DEFAULT
		, #{memberName}
		, #{memberNickname}
		, #{memberPhone}
		, DEFAULT
		, DEFAULT, DEFAULT, DEFAULT)
	</insert>
	
	<!-- 네이버 계정 이메일로 로그인 -->
	<select id="naverLoginMember" resultMap="member_rm">
		SELECT MEMBER_NO, MEMBER_EMAIL, MEMBER_PW, MEMBER_NAME, MEMBER_NICKNAME,
		MEMBER_PHONE, MEMBER_PROFILE_IMG, MEMBER_TYPE,
		TO_CHAR(ENROLL_DATE, 'YYYY"년" MM"월" DD"일" HH24"시" MI"분" SS"초"') AS ENROLL_DATE
		FROM "MEMBER"
		WHERE MEMBER_DEL_FL = 'N'
		AND MEMBER_EMAIL = #{memberEmail}
	</select>
	
	
	
	
	
	
	<!-- 마이페이지 구매 내역 값 뿌리기 -->
	
	
	
	
</mapper>